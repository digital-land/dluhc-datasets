{% extends 'layouts/base.html' %}

{% block content %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    {% if records | length > 0 %}
      <section class="app-table-container">
        <table class="app-data-table">
          <thead class="app-data-table__head">
            <tr class="app-data-table__row">
              {% for field in dataset.sorted_fields() %}
                <th scope="col" class="app-data-table__header">
                  <span class="app-data-table__header__label">{{ field.field }}</span>
                </th>
              {% endfor %}
              <th scope="col" class="app-data-table__header app-data-table__header--ui">
                <span class="app-data-table__header__label">Action</span>
              </th>
            </tr>
          </thead>
          <tbody class="app-data-table__body">
            {% for record in records %}
              <tr class="app-data-table__row">
              {% for field in dataset.sorted_fields() %}
                <td class="app-data-table__cell app-data-table__cell--ui">
                  {{ record.data.get(field.field, None)| value_or_empty_string | replace('-','&#8209;') | safe }}
                  {% if record.changes and record.changes.get(field.field) %}
                    <p class="govuk-body-s">({{record.changes.get(field.field)}})</p>
                  {% endif %}
                </td>
              {% endfor %}
              <td class="app-data-table__cell app-data-table__cell--ui">
                {% if record.changes %}
                  {{
                    buttonMenu({
                    "items": [
                          {
                            "element": "a",
                            "text": "Update record",
                            "classes": "govuk-button--secondary",
                            "href": "#",
                          }
                      ]
                    })
                  }}
                {% endif %}
              </td>
            {% endfor %}
          </tbody>
        </table>
      </section>
    {% endif %}
{% endblock content %}
